<!DOCTYPE html>
<head>
    <title>Hypnagogia</title>
    <style>
        body {
            background: url("/images/background/moroccan-flower-brown.png");
            animation: scrollBackground 150s linear infinite;
            background-size: 600px;
        }
        @keyframes scrollBackground {
            0% {
                background-position: 0 0;
            }
            100% {
                background-position: 0 1000%;
            }
        }
        canvas {
            background-color: white;
            width: 100%;
            height: 100%;
        }
        .windowContainer {
            position: absolute;
            left: calc(50vw - 400px);
            top: calc(50vh - 300px);
            width: 800px;
        }
        @media (max-width: 800px) {
            .windowContainer {
                width: 100% !important;
                height: auto;
                left: 0;
                top: calc(50vh - 300px);
            }
            .windowBorder {
                image-rendering: auto;
            }
        }
        @font-face {
            font-family: 'ashPixel';
            src: url(/wyndOS/games/wyndQST/assets/font/ashlander-pixel.otf.woff2/ashlander-pixel.otf.woff2);
        }
        @font-face {
            font-family: 'Jersey 10';
            src: url(/plugins/jersey/Jersey10-Regular.woff2);
        }
        .windowBorder {
            position: absolute;
            left: calc(-1/8 * 100%);
            top: calc(-1/6 * 102%);
            width: calc(5/4 * 100%);
            height: calc(4/3 * 100%);
            pointer-events: none;
            filter: drop-shadow(0px 0px 2vw black);
            image-rendering: pixelated;
            outline: 5px solid rgb(174, 167, 132);
            outline-style: ridge;
        }
        .text {
            font-family: 'ashPixel', monospace;
            image-rendering: pixelated;
            -webkit-font-smoothing: none;
            -moz-osx-font-smoothing: grayscale;
            text-rendering: optimizeSpeed;
            color: white;
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
        }
    </style>
</head>
<html>
    <body>
        <div class="windowContainer">
            <canvas id="window" width="800" height="600"></canvas>

            <div class="text" id="textA">
                <!--Text is added here via innerHTML args in main.js.-->
            </div>

            <img src="/wyndOS/games/wyndQST/border.png" class="windowBorder">
        </div>
    </body>
    <script src="/wyndOS/games/wyndQST/scripts/main.js"></script>
    <script>
        // This manages reading text sizes from data-base-font applied to divs.
        // Since text is written from innerHTML args in main.js, a mutation observer is used to update this.
        // The benefit of doing text in this way is that text size will remain proportional to the game window size.
        function adjustTextSize() {
            const container = document.querySelector('.windowContainer');
            const width = Math.min(container.clientWidth, 800); // Clamp to 800px max
            const baseWidth = 800;
            document
                .querySelectorAll('#textA [data-base-font]')
                .forEach(el => {
                    const baseFont = parseFloat(el.dataset.baseFont);
                    el.style.fontSize = (width / baseWidth * baseFont) + 'px';
                });
        }

        window.addEventListener('resize', adjustTextSize);

        const textA = document.getElementById('textA');
        const observer = new MutationObserver(muts => {
        for (let m of muts) {
            if (m.type === 'childList' && m.addedNodes.length) {
            adjustTextSize();
            break;
            }
        }
        });
        observer.observe(textA, { childList: true });

        window.addEventListener('DOMContentLoaded', adjustTextSize);
</script>
</html>